#!/usr/bin/env ruby
require 'rubygems'
require 'epitools'

count = ARGV.first ? ARGV.first.to_i : nil

paths = Dir['**/*'].select{|fn| not File.directory?(fn)}

# Get modification times
paths = paths.map do |fn|
  mtime = File.mtime(fn) rescue nil
  next unless mtime
  [mtime, fn]
end.compact

paths = paths.sort[-count..-1] if count

grouped = paths.group_by{|t,f| t}.sort

for group, paths in grouped
  
  puts group.inspect.light_blue
  
  for time, path in paths
    dir, file = File.split(path)
    print "  "
    print "#{dir}/".light_white unless dir == "."
    puts file.white
  end
  
  puts
  
end
