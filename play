#!/usr/bin/env ruby

if ARGV.empty?
  puts "usage: play <video url>"
  return 1
end

# click
system("mplayer", "-really-quiet", "#{ENV["HOME"]}/scripts/sounds/click.mp3")

url = ARGV.first
media_url, title = `youtube-dl -o "%(title)s (%(id)s)" --no-playlist -g --get-filename "#{url}"`.lines.take(2).map(&:strip)

cmd = %w[mplayer -title] + 
        [title] + 
        %w[-really-quiet -cache 20000 -cache-min 0.0128] + 
        [media_url]

p title: title, cmd: cmd

system(*cmd)
